# 任务 005: AI 辅助创建 SKILL（自然语言 → `SKILL.md`）

## 目标

允许用户用自然语言描述需求，由 AI 生成候选 `SKILL.md`（含元数据/约束/上下文规则/变体建议），用户确认后才落盘并可立即运行；全流程支持取消/超时/重试，并记录必要证据（不落正文内容）。

## 依赖

- 任务 004：Skill Studio（提供创建入口与编辑/确认 UI）

## 实现步骤

1. 定义生成输入：
   - 用户描述（需求/场景）
   - 选择作用域（Global/Project）
   - 可选：样例文本片段（用户主动提供）
2. 设计生成 prompt（生成“结构化 YAML + 建议正文段落”）：
   - 强制输出可解析格式
   - 限制长度，默认生成同时给出 low-tier 变体建议
3. 实现生成执行：
   - 通过主进程代理 AI 请求（与现有 `ai:skill:run` 复用或新增专用 channel）
   - 支持取消、超时、错误码映射
4. 生成结果进入“审阅与编辑”环节：
   - 校验通过才允许保存
   - UI 高亮潜在风险：过长、约束缺失、路由字段不完整
5. E2E：
   - 生成 → 审阅 → 保存 → 列表出现 → 可运行
   - 取消/超时/失败 → 状态清理且可重试

## 新增/修改文件

- `src/components/skills/SkillGenerator.tsx`（新增）
- `src/stores/skillsStore.ts`（修改）：生成状态机（idle/streaming/done/error/canceled）
- `electron/ipc/skills.cjs`（修改）：新增 `skill:generate`（或复用 ai channel，但必须区分语义与结果）
- `tests/e2e/`（新增/修改）：生成与失败分支

## 验收标准

- [ ] 用户用自然语言可生成候选 `SKILL.md`，并在确认后落盘
- [ ] 生成全流程支持取消/超时/错误码，且 pending 状态会被清理
- [ ] 保存前必须通过校验器；不允许写入无效 skill
- [ ] E2E 覆盖成功与取消/超时/失败分支

