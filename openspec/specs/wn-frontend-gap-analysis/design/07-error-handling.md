# Design: 错误处理缺口

## 现状分析

后端有 IPC 错误码和崩溃快照机制，但前端无对应的错误处理 UI。

### 缺失功能

| 功能 | 后端支持 | 优先级 | 备注 |
|------|---------|-------|------|
| 崩溃恢复对话框 | 有快照机制 | P0 | 有快照，无恢复 UI |
| 错误日志查看器 | 有 | P1 | 无查看界面 |
| 错误上报入口 | 无 | P2 | 无上报功能 |
| 文件冲突解决 UI | 有 | P2 | 无冲突解决界面 |

## 设计方案

### 1. 崩溃恢复对话框

触发时机：检测到未保存内容的崩溃快照

显示内容：
- 崩溃时间
- 可恢复的文件列表
- 恢复/丢弃选项

### 2. 错误日志查看器

入口：Help > View Logs

功能：
- 显示最近错误日志
- 支持过滤和搜索
- 支持导出

### 3. 错误上报

- 可选的错误上报功能
- 脱敏处理敏感数据
- 用户确认后上报

## 技术实现

- 崩溃恢复使用现有的快照 IPC
- 日志查看使用 Theia 日志服务
- 错误上报需新增后端端点

## 文件变更预期

| 操作 | 文件路径 |
|------|---------|
| Add | `writenow-core/src/browser/crash-recovery-dialog.tsx` |
| Add | `writenow-core/src/browser/log-viewer-widget.tsx` |
| Update | `writenow-core/src/browser/writenow-core-frontend-module.ts` |
