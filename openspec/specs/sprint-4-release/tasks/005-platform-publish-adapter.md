# 任务 005: 多平台发布格式适配

## 目标

实现面向微信公众号、知乎、小红书、今日头条、Medium 的发布格式适配（MVP：模板导出 + 剪贴板一键复制），输出可直接粘贴发布的内容，并提供必要的平台规则提示。

## 依赖

- 任务 002：Markdown 导出（作为通用内容源）
- 具备剪贴板写入能力（渲染进程或主进程）

## 实现步骤

1. 定义平台与输出格式：
   - 公众号：以 HTML + 剪贴板富文本为主（限制外链/样式差异需提示）
   - 知乎：优先 Markdown（提示字数/图片限制）
   - 小红书：纯文本/轻量模板（强调图片与短文本的提示）
   - 头条：标准 HTML
   - Medium：Markdown/HTML（按实现选一种稳定方案）
2. 实现“模板生成器”：
   - 输入：文档内容（Markdown/等价表示）+ 文档标题 + 可选元信息
   - 输出：平台适配内容（string）+ warnings（规则提示）
3. UI（发布/导出面板）：
   - 选择目标平台
   - 展示生成结果预览（或可展开查看）
   - 一键复制到剪贴板，并提示成功/失败
4. 平台规则处理（最小化）：
   - 对明显不可用的元素给出提示（如外链/复杂样式）
   - 可选：提供“降级为纯文本/移除外链”的开关
5. 证据与可追踪：
   - 生成与复制失败需提供明确错误信息（禁止 silent failure）

## 新增/修改文件

- `src/lib/publish/*`（新增）- 平台模板生成器
- `src/components/Publish/*`（新增/修改）- 平台选择 + 预览 + 复制
- `electron/ipc/clipboard.cjs`（可选新增）- 主进程剪贴板/HTML 复制能力封装（若渲染侧受限）

## 验收标准

- [ ] 支持选择 5 个目标平台并生成对应输出内容
- [ ] 支持“一键复制到剪贴板”，并有明确成功反馈
- [ ] 平台关键规则差异有必要提示（公众号外链/知乎限制/小红书短文本/头条 HTML 等）
- [ ] 失败时展示明确错误信息并可重试

## 参考

- 核心规范：`openspec/specs/writenow-spec/spec.md` 第 436-473 行（多平台发布 + 适配要点）

