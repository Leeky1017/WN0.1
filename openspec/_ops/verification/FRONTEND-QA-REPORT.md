# WriteNow 前端 QA 报告

日期: 2026-01-25
测试环境: Browser mode, localhost:3000
Issue: #197

## 测试结果汇总

| 批次 | 通过 | 失败 | 阻塞 |
|------|------|------|------|
| P0   | 5/8  | 1/8  | 2/8  |
| P1   | 0/10 | 0/10 | 10/10 |
| P2   | 0/8  | 0/8  | 8/8  |
| P3   | 0/4  | 0/4  | 4/4  |

## Bug 列表

### BUG-001: [严重] [P0-002] AI API Key 设置未注册到设置系统

**复现步骤**:
1. 按 F1 打开命令面板
2. 输入 "settings" 选择 "Preferences: Open Settings (UI)"
3. 在设置搜索框中输入 "writenow.ai" 或 "api key"

**预期结果**: 显示 AI API Key 相关设置选项

**实际结果**: 显示 "No Settings Found" - 没有找到任何 WriteNow AI 相关设置

**截图**: 已记录

**影响**: 用户无法通过设置面板配置 AI API Key，阻塞 AI 功能使用

---

## 体验问题

### UX-001: [P0-001] 快捷键 Ctrl+, 无法打开设置面板

**问题描述**: Welcome 页面显示设置快捷键为 ⌘, (Ctrl+,)，但按下后没有反应，需要通过 F1 命令面板才能打开设置

**改进建议**: 确保 Ctrl+, 快捷键正确注册并能在任何上下文下打开设置面板

### UX-002: [P0-003] 编辑器工具栏位置不明显

**问题描述**: 打开新文件后没有看到预期的编辑器工具栏（撤销/重做/格式/标题），需要进一步验证 .md 文件场景

**改进建议**: 如果工具栏存在，需要确保在编辑器顶部位置可见

### UX-003: [通用] DOM 引用频繁失效

**问题描述**: 使用 MCP Browser 进行自动化测试时，元素引用频繁失效（stale），表明 Theia 应用 DOM 更新频繁

**改进建议**: 这可能影响其他自动化测试工具，建议优化 DOM 更新策略

---

## 验证详情

### P0 核心功能（8 项）

#### P0-001 设置面板
- 状态: **PASS**
- 验证步骤: F1 > 输入 "settings" > 选择 "Preferences: Open Settings (UI)"
- 预期结果: 设置面板打开，显示 AI/编辑器/外观/快捷键/语言分类
- 实际结果: 设置面板正确打开，显示 User/Workspace 标签页，包含 Commonly Used、Text Editor、Workbench、AI Features 等分类
- 备注: Ctrl+, 快捷键不生效（见 UX-001）

#### P0-002 API Key 配置
- 状态: **FAIL**
- 验证步骤: 设置面板 > 搜索 "writenow.ai" 或 "api key"
- 预期结果: 可输入、可显示/隐藏、可保存
- 实际结果: 显示 "No Settings Found" - AI API Key 设置未注册
- 备注: 见 BUG-001

#### P0-003 编辑器工具栏
- 状态: **BLOCKED**
- 验证步骤: 打开 .md 文件
- 预期结果: 顶部显示工具栏（撤销/重做/格式/标题）
- 实际结果: 创建新文件时未观察到专用工具栏，需进一步验证 .md 文件场景
- 备注: 需要打开现有 .md 文件验证

#### P0-004 查找/替换
- 状态: **PASS**
- 验证步骤: Ctrl+F
- 预期结果: 查找面板打开，输入后高亮匹配
- 实际结果: 查找面板正确打开，包含 Find 输入框、Match Case、Match Whole Word、Use Regular Expression 选项、Previous/Next Match 按钮
- 备注: 功能完整

#### P0-005 状态栏字数
- 状态: **PASS**
- 验证步骤: 查看状态栏
- 预期结果: 状态栏显示"X 字"
- 实际结果: 状态栏显示 "0 字"
- 备注: Welcome 页面加载后即可见

#### P0-006 AI 状态
- 状态: **PASS**
- 验证步骤: 查看状态栏左侧
- 预期结果: 显示 AI 连接状态指示器
- 实际结果: 状态栏显示 "AI 未连接"
- 备注: 状态指示器正常工作

#### P0-007 崩溃恢复
- 状态: **BLOCKED**
- 验证步骤: 需模拟崩溃场景
- 预期结果: 启动时有快照则弹出恢复对话框
- 实际结果: 未测试
- 备注: 需要专门的崩溃模拟场景

#### P0-008 最近文件
- 状态: **PASS**
- 验证步骤: Welcome 页面
- 预期结果: 显示最近打开的文件列表
- 实际结果: Welcome 页面显示 "暂无最近打开的文件"（符合首次启动预期）
- 备注: 功能可见，需要有历史文件才能验证列表显示

### P1 日常功能（10 项）

#### P1-001 编辑器右键
- 状态: PENDING
- 验证步骤: 编辑器内右键
- 预期结果: 显示剪切/复制/粘贴/AI 菜单
- 备注:

#### P1-002 文件树右键
- 状态: PENDING
- 验证步骤: 文件树右键文件
- 预期结果: 显示新建/重命名/删除菜单
- 备注:

#### P1-003 大纲面板
- 状态: PENDING
- 验证步骤: View > Outline
- 预期结果: 显示文档标题结构
- 备注:

#### P1-004 导出菜单
- 状态: PENDING
- 验证步骤: File > Export
- 预期结果: 显示 Markdown/Word/PDF 选项
- 备注:

#### P1-005 语言切换
- 状态: PENDING
- 验证步骤: 设置 > 语言
- 预期结果: 切换后界面文本变化
- 备注:

#### P1-006 快捷键表
- 状态: PENDING
- 验证步骤: Help > Keyboard Shortcuts 或 Ctrl+?
- 预期结果: 显示快捷键列表
- 备注:

#### P1-007 关于对话框
- 状态: PENDING
- 验证步骤: Help > About WriteNow
- 预期结果: 显示版本信息
- 备注:

#### P1-008 通知中心
- 状态: PENDING
- 验证步骤: 状态栏通知图标
- 预期结果: 点击显示通知列表
- 备注:

#### P1-009 插入媒体
- 状态: PENDING
- 验证步骤: 工具栏链接/图片/表格按钮
- 预期结果: 弹出输入对话框
- 备注:

#### P1-010 专注模式
- 状态: PENDING
- 验证步骤: Ctrl+Shift+F 或 View > Focus Mode
- 预期结果: 隐藏侧边栏，编辑区居中
- 备注:

### P2 专业功能（8 项）

#### P2-001 可访问性
- 状态: PENDING
- 验证步骤: Tab 键导航
- 预期结果: 焦点指示器清晰可见
- 备注:

#### P2-002 高对比度
- 状态: PENDING
- 验证步骤: 设置 > 外观 > 主题
- 预期结果: 有高对比度主题选项
- 备注:

#### P2-003 角色管理
- 状态: PENDING
- 验证步骤: View > Characters
- 预期结果: 显示角色列表，可 CRUD
- 备注:

#### P2-004 术语表
- 状态: PENDING
- 验证步骤: View > Terminology
- 预期结果: 显示术语列表，可 CRUD
- 备注:

#### P2-005 写作统计
- 状态: PENDING
- 验证步骤: View > Writing Stats
- 预期结果: 显示统计数据
- 备注:

#### P2-006 日志查看
- 状态: PENDING
- 验证步骤: Help > View Logs
- 预期结果: 显示日志列表
- 备注:

#### P2-007 用户指南
- 状态: PENDING
- 验证步骤: Help > User Guide
- 预期结果: 显示帮助文档
- 备注:

#### P2-008 自动更新
- 状态: PENDING
- 验证步骤: 启动时
- 预期结果: 有新版本时显示通知
- 备注:

### P3 进阶功能（4 项）

#### P3-001 上下文调试器
- 状态: PENDING
- 验证步骤: View > Developer > Context Debugger
- 预期结果: 显示上下文层级和 token 用量
- 备注:

#### P3-002 语义搜索
- 状态: PENDING
- 验证步骤: Ctrl+Shift+P 或 Edit > Semantic Search
- 预期结果: 输入查询返回相关片段
- 备注:

#### P3-003 约束编辑器
- 状态: PENDING
- 验证步骤: View > Constraints
- 预期结果: 显示约束列表，可 CRUD
- 备注:

#### P3-004 记忆查看器
- 状态: PENDING
- 验证步骤: View > Memory
- 预期结果: 显示记忆列表，可编辑/删除
- 备注:
